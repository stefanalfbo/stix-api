using System.Net;
using Shouldly;
using StixApi.IntegrationTests.Fixtures;

namespace StixApi.IntegrationTests;

public class VulnerabilityControllerTests : IntegrationTest
{
    public VulnerabilityControllerTests(StixApiWebApplicationFactory fixture)
        : base(fixture)
    {
    }

    [Fact]
    public async Task Get_All_Vulnerabilities()
    {
        // Act
        var response = await _client.GetAsync("/v1/api/vulnerabilities");

        // Assert
        response.StatusCode.ShouldBe(HttpStatusCode.OK);
    }
}
