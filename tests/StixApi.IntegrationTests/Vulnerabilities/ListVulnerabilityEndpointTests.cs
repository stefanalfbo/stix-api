using System.Net;
using System.Text.Json;
using Shouldly;
using StixApi.IntegrationTests.Fixtures;

namespace StixApi.IntegrationTests.Vulnerabilities;

public class ListVulnerabilityEndpointTests : IntegrationTest
{
    public ListVulnerabilityEndpointTests(StixApiWebApplicationFactory fixture)
        : base(fixture)
    {
    }

    [Fact]
    public async Task List_Vulnerabilities()
    {
        // Act
        var response = await _client.GetAsync("/v1/api/vulnerabilities");

        // Assert
        response.StatusCode.ShouldBe(HttpStatusCode.OK);
    }
}
