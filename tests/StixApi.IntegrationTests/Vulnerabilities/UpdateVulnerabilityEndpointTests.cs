using System.Net;
using System.Text.Json;
using Shouldly;
using StixApi.IntegrationTests.Fixtures;

namespace StixApi.IntegrationTests.Vulnerabilities;

public class UpdateVulnerabilityEndpointTests : IntegrationTest
{
    public UpdateVulnerabilityEndpointTests(StixApiWebApplicationFactory fixture)
        : base(fixture)
    {
    }

    [Fact(Skip = "This test is skipped because it requires a valid token.")]
    public async Task Update_Vulnerability_That_Do_Not_Exist()
    {
        // Act
        var response = await _client.PutAsync("/v1/api/vulnerabilities/vulnerability--e9eb06c9-ebc1-47a6-a009-4702bd9f744c",
            new StringContent(
                JsonSerializer.Serialize(new
                {
                    Id = "vulnerability--e9eb06c9-ebc1-47a6-a009-4702bd9f744c",
                    Description = "Updated description",
                    Revoked = false,
                    Confidence = 100
                }),
                System.Text.Encoding.UTF8,
                "application/json"));

        // Assert
        response.StatusCode.ShouldBe(HttpStatusCode.NotFound);
    }
}
