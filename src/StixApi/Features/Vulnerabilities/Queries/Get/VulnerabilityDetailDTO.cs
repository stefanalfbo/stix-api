using System.Text.Json.Serialization;

namespace StixApi.Features.Vulnerabilities.Queries.Get;

public class VulnerabilityDetailDTO
{
    /// <summary>
    /// The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The 
    /// value of the type field MUST be 'vulnerability'.
    /// </summary>
    [JsonPropertyName("type")]
    public required string Type { get; set; }

    /// <summary>
    /// The version of the STIX specification used to represent this object.
    /// </summary>
    [JsonPropertyName("spec_version")]
    public required string SpecificationVersion { get; set; }

    /// <summary>
    /// The id property universally and uniquely identifies this object.
    /// </summary>
    [JsonPropertyName("id")]
    public required string Id { get; set; }

    /// <summary>
    /// The created property represents the time at which the first version 
    /// of this object was created. The timstamp value MUST be precise to 
    /// the nearest millisecond.
    /// </summary>
    [JsonPropertyName("created")]
    public required string Created { get; set; }

    /// <summary>
    /// The modified property represents the time that this particular version 
    /// of the object was modified. The timstamp value MUST be precise to the 
    /// nearest millisecond.
    /// </summary>
    [JsonPropertyName("modified")]
    public required string Modified { get; set; }

    /// <summary>
    /// The name used to identify the Vulnerability.
    /// </summary>
    [JsonPropertyName("name")]
    public required string Name { get; set; }

    /// <summary>
    /// The ID of the Source object that describes who created this object.
    /// </summary>
    [JsonPropertyName("created_by_ref")]
    public string? CreatedByRef { get; set; }

    /// <summary>
    /// The revoked property indicates whether the object has been revoked.
    /// </summary>
    [JsonPropertyName("revoked")]
    public bool? Revoked { get; set; }

    /// <summary>
    /// The labels property specifies a set of terms used to describe this object.
    /// </summary>
    [JsonPropertyName("labels")]
    public List<string>? Labels { get; set; }

    /// <summary>
    /// Identifies the confidence that the creator has in the correctness of their data.
    /// </summary>
    [JsonPropertyName("confidence")]
    public int? Confidence { get; set; }

    /// <summary>
    /// Identifies the language of the text content in this object.
    /// </summary>
    [JsonPropertyName("lang")]
    public string? Language { get; set; }

    /// <summary>
    /// A list of external references which refers to non-STIX information.
    /// </summary>
    [JsonPropertyName("external_references")]
    public List<ExternalReferenceDetailDTO>? ExternalReferences { get; set; }

    /// <summary>
    /// The list of marking-definition objects to be applied to this object.
    /// </summary>
    [JsonPropertyName("object_marking_refs")]
    public List<string>? ObjectMarkingRefs { get; set; }

    /// <summary>
    /// The set of granular markings that apply to this object.
    /// </summary>
    [JsonPropertyName("granular_markings")]
    public List<GranularMarkingDetailDTO>? GranularMarkings { get; set; }


    /// <summary>
    /// Specifies any extensions of the object, as a dictionary.
    /// </summary>
    [JsonPropertyName("extensions")]
    public Dictionary<string, object>? Extensions { get; set; }

    /// <summary>
    /// A description that provides more details and context about the Vulnerability.
    /// </summary>
    [JsonPropertyName("description")]
    public string? Description { get; set; }
}

/// <summary>
/// The granular-marking type defines how the list of marking-definition objects referenced by 
/// the marking_refs property to apply to a set of content identified by the list of selectors 
/// in the selectors property.
/// </summary>
public class GranularMarkingDetailDTO
{
    /// <summary>
    /// A list of selectors for content contained within the STIX object in which this property appears.
    /// </summary>
    [JsonPropertyName("selectors")]
    public required List<string> Selectors { get; set; }

    /// <summary>
    /// Identifies the language of the text identified by this marking.
    /// </summary>
    [JsonPropertyName("lang")]
    public string? Language { get; set; }

    /// <summary>
    /// The marking_ref property specifies the ID of the marking-definition object that describes 
    /// the marking.
    /// </summary>
    [JsonPropertyName("marking_ref")]
    public required string MarkingRef { get; set; }
}

/// <summary>
/// External references are used to describe pointers to 
/// information represented outside of STIX.
/// </summary>
public class ExternalReferenceDetailDTO
{
    /// <summary>
    /// The source within which the external-reference is defined (system, registry, organization, etc.)
    /// </summary>
    [JsonPropertyName("source_name")]
    public required string SourceName { get; set; }

    /// <summary>
    /// An identifier for the external reference content.
    /// </summary>
    [JsonPropertyName("external_id")]
    public string? ExternalId { get; set; }

    /// <summary>
    /// A human readable description
    /// </summary>
    [JsonPropertyName("description")]
    public string? Description { get; set; }

    /// <summary>
    /// A URL reference to an external resource [RFC3986].
    /// </summary>
    [JsonPropertyName("url")]
    public string? Url { get; set; }

    /// <summary>
    /// Specifies a dictionary of hashes for the file.
    /// </summary>
    [JsonPropertyName("hashes")]
    public Dictionary<string, string>? Hashes { get; set; }
}