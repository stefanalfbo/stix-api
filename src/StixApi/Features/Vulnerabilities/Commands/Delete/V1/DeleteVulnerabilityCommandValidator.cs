using FluentValidation;

namespace StixApi.Features.Vulnerabilities.Commands.Delete.V1;

public class DeleteVulnerabilityCommandValidator : AbstractValidator<DeleteVulnerabilityCommand>
{
    public DeleteVulnerabilityCommandValidator()
    {
        RuleFor(v => v.Id)
            .NotEmpty().WithMessage("id is required")
            .Matches(@"^vulnerability--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$")
            .WithMessage("Id must follow the pattern: vulnerability--GUID");
    }
}