using FluentValidation;

namespace StixApi.Features.Vulnerabilities.Commands;

public class CreateVulnerabilityCommandValidator : AbstractValidator<CreateVulnerabilityCommand>
{
    public CreateVulnerabilityCommandValidator()
    {
        RuleFor(v => v.Type)
            .Equal("vulnerability")
            .WithMessage("Type must be 'vulnerability'");

        RuleFor(v => v.SpecificationVersion)
            .Must(v => v == "2.0" || v == "2.1")
            .WithMessage("SpecVersion must be either '2.0' or '2.1'");
    }
}