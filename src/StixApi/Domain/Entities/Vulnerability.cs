
using StixApi.Domain.Common;

namespace StixApi.Domain.Entities;

public class Vulnerability
{
    /// <summary>
    /// The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The 
    /// value of the type field MUST be 'vulnerability'.
    /// </summary>
    public required string Type { get; set; }

    /// <summary>
    /// The version of the STIX specification used to represent this object.
    /// </summary>
    public required string SpecificationVersion { get; set; }

    /// <summary>
    /// The id property universally and uniquely identifies this object.
    /// </summary>
    public required string Id { get; set; }

    /// <summary>
    /// The created property represents the time at which the first version 
    /// of this object was created. The timstamp value MUST be precise to 
    /// the nearest millisecond.
    /// </summary>
    public required DateTime Created { get; set; }

    /// <summary>
    /// The modified property represents the time that this particular version 
    /// of the object was modified. The timstamp value MUST be precise to the 
    /// nearest millisecond.
    /// </summary>
    public required DateTime Modified { get; set; }

    /// <summary>
    /// The name used to identify the Vulnerability.
    /// </summary>
    public required string Name { get; set; }

    /// <summary>
    /// The ID of the Source object that describes who created this object.
    /// </summary>
    public string? CreatedByRef { get; set; }

    /// <summary>
    /// The revoked property indicates whether the object has been revoked.
    /// </summary>
    public bool? Revoked { get; set; }

    /// <summary>
    /// The labels property specifies a set of terms used to describe this object.
    /// </summary>
    public List<string>? Labels { get; set; }

    /// <summary>
    /// Identifies the confidence that the creator has in the correctness of their data.
    /// </summary>
    public int? Confidence { get; set; }

    /// <summary>
    /// Identifies the language of the text content in this object.
    /// </summary>
    public string? Language { get; set; }

    /// <summary>
    /// A list of external references which refers to non-STIX information.
    /// </summary>
    public List<ExternalReference>? ExternalReferences { get; set; }

    /// <summary>
    /// The list of marking-definition objects to be applied to this object.
    /// </summary>
    public List<string>? ObjectMarkingRefs { get; set; }

    /// <summary>
    /// The set of granular markings that apply to this object.
    /// </summary>
    public List<GranularMarking>? GranularMarkings { get; set; }

    // TODO
    // <summary>
    // Specifies any extensions of the object, as a dictionary.
    // </summary>
    // [JsonPropertyName("extensions")]
    // public Dictionary<string, object>? Extensions { get; set; }

    /// <summary>
    /// A description that provides more details and context about the Vulnerability.
    /// </summary>
    public string? Description { get; set; }

}